<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Issue to AI Prompt</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="header-content">
        <svg class="logo-icon" viewBox="0 0 16 16" width="20" height="20" fill="currentColor">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
        </svg>
        <h1 class="header-title">Issue to AI Prompt</h1>
      </div>
      <button id="settings-btn" class="icon-btn" title="Settings">
        <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
          <path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.04.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.29-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.04-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.212-.224L5.84 1.29c.168-.646.715-1.196 1.458-1.26A8.094 8.094 0 0 1 8 0zm0 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z"/>
        </svg>
      </button>
    </header>

    <!-- Main Content -->
    <main class="popup-main">
      <!-- Status Message (shown when no data) -->
      <div id="status-message" class="status-message">
        <svg class="status-icon" viewBox="0 0 16 16" width="48" height="48" fill="currentColor">
          <path d="M8 1.5a6.5 6.5 0 1 0 6.5 6.5A6.5 6.5 0 0 0 8 1.5zM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8z"/>
          <path d="M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75zM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
        </svg>
        <p>Navigate to a GitHub issue page and click the <strong>"Generate AI Prompt"</strong> button to extract data.</p>
      </div>

      <!-- Prompt Editor (shown when data available) -->
      <div id="prompt-editor" class="prompt-editor hidden">
        <!-- Issue Info Bar -->
        <div class="issue-info">
          <span id="issue-title" class="issue-title"></span>
          <a id="issue-link" class="issue-link" href="#" target="_blank" title="Open issue in new tab">
            <svg viewBox="0 0 16 16" width="12" height="12" fill="currentColor">
              <path d="M9 2H7V1h6v6h-1V2.707l-5.146 5.147-.708-.708L11.293 2H9z"/>
              <path d="M2 4a1 1 0 0 1 1-1h4v1H3v9h9V9h1v5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4z"/>
            </svg>
          </a>
        </div>

        <!-- Generation Mode -->
        <div class="generation-mode">
          <button id="ai-generate-btn" class="btn btn-ai">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
              <path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729z"/>
            </svg>
            <span id="ai-btn-text">Generate with AI</span>
          </button>
          <div id="ai-status" class="ai-status hidden">
            <span class="ai-status-text"></span>
          </div>
        </div>

        <!-- Template Selector (fallback) -->
        <div class="template-selector">
          <label for="template-select">Or use template:</label>
          <select id="template-select" class="template-dropdown">
            <optgroup label="Default Templates">
              <option value="bug-fix">Bug Fix</option>
              <option value="feature-request">Feature Request</option>
              <option value="code-review">Code Review</option>
              <option value="question-help">Question / Help</option>
              <option value="minimal">Minimal</option>
              <option value="detailed">Detailed</option>
            </optgroup>
            <optgroup id="custom-templates-group" label="Custom Templates">
            </optgroup>
          </select>
        </div>

        <!-- Prompt Textarea -->
        <div class="prompt-container">
          <textarea id="prompt-textarea" class="prompt-textarea" placeholder="Click 'Generate with AI' or select a template to create your prompt..."></textarea>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
          <span class="stat-item" id="stat-code-blocks" title="Code blocks">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M4.72 3.22a.75.75 0 0 1 1.06 1.06L2.06 8l3.72 3.72a.75.75 0 1 1-1.06 1.06L.47 8.53a.75.75 0 0 1 0-1.06l4.25-4.25zm6.56 0a.75.75 0 1 0-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 1 0 1.06 1.06l4.25-4.25a.75.75 0 0 0 0-1.06l-4.25-4.25z"/>
            </svg>
            <span id="code-block-count">0</span>
          </span>
          <span class="stat-item" id="stat-comments" title="Comments">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
            </svg>
            <span id="comment-count">0</span>
          </span>
          <span class="stat-item" id="stat-labels" title="Labels">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M2.5 7.775V2.75a.25.25 0 0 1 .25-.25h5.025a.25.25 0 0 1 .177.073l6.25 6.25a.25.25 0 0 1 0 .354l-5.025 5.025a.25.25 0 0 1-.354 0l-6.25-6.25a.25.25 0 0 1-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775zM6 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
            </svg>
            <span id="label-count">0</span>
          </span>
        </div>
      </div>
    </main>

    <!-- Footer Actions -->
    <footer class="popup-footer">
      <button id="regenerate-btn" class="btn btn-secondary" disabled>
        <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
          <path d="M8 2.5a5.5 5.5 0 1 0 5.5 5.5.5.5 0 0 1 1 0 6.5 6.5 0 1 1-3.25-5.63l-.5.86A5.5 5.5 0 0 0 8 2.5z"/>
          <path d="M10.5 5V1a.5.5 0 0 1 .8-.4l3 2.25a.5.5 0 0 1 0 .8l-3 2.25a.5.5 0 0 1-.8-.4V5z"/>
        </svg>
        Regenerate
      </button>
      <button id="copy-btn" class="btn btn-primary" disabled>
        <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
          <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25v-7.5z"/>
          <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25v-7.5zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-7.5z"/>
        </svg>
        <span id="copy-btn-text">Copy to Clipboard</span>
      </button>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
