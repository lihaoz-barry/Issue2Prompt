<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Issue to AI Prompt - Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="options-container">
    <!-- Header -->
    <header class="options-header">
      <div class="header-content">
        <svg class="logo-icon" viewBox="0 0 16 16" width="32" height="32" fill="currentColor">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
        </svg>
        <div class="header-text">
          <h1>GitHub Issue to AI Prompt</h1>
          <p>Configure your extension settings and custom templates</p>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="options-main">
      <!-- OpenAI API Configuration Section -->
      <section class="settings-section api-section">
        <h2 class="section-title">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="vertical-align: middle; margin-right: 8px;">
            <path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"/>
          </svg>
          OpenAI API Configuration
        </h2>

        <div class="api-status" id="api-status">
          <span class="status-indicator status-unconfigured"></span>
          <span class="status-text">API key not configured</span>
        </div>

        <div class="setting-group">
          <label for="openai-api-key">API Key</label>
          <div class="api-key-input-wrapper">
            <input type="password" id="openai-api-key" class="text-input api-key-input" placeholder="sk-...">
            <button id="toggle-api-key-visibility" class="btn btn-icon" type="button" title="Show/Hide API Key">
              <svg id="eye-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                <path d="M8 2c1.981 0 3.671.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.45.678-1.367 1.932-2.637 3.023C11.67 13.008 9.981 14 8 14c-1.981 0-3.671-.992-4.933-2.078C1.797 10.831.88 9.577.43 8.899a1.62 1.62 0 0 1 0-1.798c.45-.678 1.367-1.932 2.637-3.023C4.33 2.992 6.019 2 8 2ZM1.679 7.932a.12.12 0 0 0 0 .136c.411.622 1.241 1.75 2.366 2.717C5.176 11.758 6.527 12.5 8 12.5c1.473 0 2.825-.742 3.955-1.715 1.124-.967 1.954-2.096 2.366-2.717a.12.12 0 0 0 0-.136c-.412-.621-1.242-1.75-2.366-2.717C10.824 4.242 9.473 3.5 8 3.5c-1.473 0-2.825.742-3.955 1.715-1.124.967-1.954 2.096-2.366 2.717ZM8 10a2 2 0 1 1-.001-3.999A2 2 0 0 1 8 10Z"/>
              </svg>
            </button>
          </div>
          <p class="setting-description">
            Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a>.
            Your key is stored locally and never sent anywhere except OpenAI.
          </p>
        </div>

        <div class="setting-group">
          <label for="openai-model">Model</label>
          <select id="openai-model" class="select-input">
            <option value="gpt-4o-mini">GPT-4o Mini (Recommended - Fast & Cheap)</option>
            <option value="gpt-4o">GPT-4o (Best Quality)</option>
            <option value="gpt-4-turbo">GPT-4 Turbo</option>
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Fastest)</option>
          </select>
          <p class="setting-description">Select the OpenAI model to use for prompt generation</p>
        </div>

        <div class="setting-group">
          <button id="test-api-btn" class="btn btn-secondary">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"/>
            </svg>
            Test API Connection
          </button>
          <span id="test-result" class="test-result"></span>
        </div>
      </section>

      <!-- General Settings Section -->
      <section class="settings-section">
        <h2 class="section-title">General Settings</h2>

        <div class="setting-group">
          <label for="default-template">Default Template</label>
          <select id="default-template" class="select-input">
            <option value="bug-fix">Bug Fix</option>
            <option value="feature-request">Feature Request</option>
            <option value="code-review">Code Review</option>
            <option value="question-help">Question / Help</option>
            <option value="minimal">Minimal</option>
            <option value="detailed">Detailed</option>
          </select>
          <p class="setting-description">Template selected by default when generating prompts</p>
        </div>

        <div class="setting-group">
          <label for="max-comments">Maximum Comments to Include</label>
          <input type="number" id="max-comments" class="number-input" min="1" max="20" value="5">
          <p class="setting-description">Limit the number of comments included in the prompt (1-20)</p>
        </div>
      </section>

      <!-- Behavior Settings Section -->
      <section class="settings-section">
        <h2 class="section-title">Behavior</h2>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="auto-close-popup">
            <span class="checkbox-text">Auto-close popup after copying</span>
          </label>
        </div>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="show-notification" checked>
            <span class="checkbox-text">Show notification on copy</span>
          </label>
        </div>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="auto-detect-type" checked>
            <span class="checkbox-text">Auto-detect issue type and recommend template</span>
          </label>
        </div>
      </section>

      <!-- Extraction Settings Section -->
      <section class="settings-section">
        <h2 class="section-title">Content Extraction</h2>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="include-comments" checked>
            <span class="checkbox-text">Include comments in prompt</span>
          </label>
        </div>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="include-code-blocks" checked>
            <span class="checkbox-text">Include code blocks in prompt</span>
          </label>
        </div>

        <div class="setting-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="include-prs" checked>
            <span class="checkbox-text">Include linked Pull Requests</span>
          </label>
        </div>
      </section>

      <!-- Custom Templates Section -->
      <section class="settings-section">
        <h2 class="section-title">Custom Templates</h2>

        <div class="templates-toolbar">
          <button id="add-template-btn" class="btn btn-primary">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M8 2a.75.75 0 0 1 .75.75v4.5h4.5a.75.75 0 0 1 0 1.5h-4.5v4.5a.75.75 0 0 1-1.5 0v-4.5h-4.5a.75.75 0 0 1 0-1.5h4.5v-4.5A.75.75 0 0 1 8 2z"/>
            </svg>
            Add New Template
          </button>
        </div>

        <div id="custom-templates-list" class="templates-list">
          <!-- Templates will be populated here -->
        </div>

        <div id="no-templates-message" class="no-templates-message">
          <p>No custom templates yet. Click "Add New Template" to create one.</p>
        </div>
      </section>

      <!-- Import/Export Section -->
      <section class="settings-section">
        <h2 class="section-title">Import / Export</h2>

        <div class="import-export-buttons">
          <button id="import-btn" class="btn btn-secondary">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
              <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
            </svg>
            Import Templates
          </button>
          <button id="export-btn" class="btn btn-secondary">
            <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
              <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
              <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
            </svg>
            Export Templates
          </button>
          <input type="file" id="import-file-input" accept=".json" style="display: none;">
        </div>
      </section>

      <!-- History Section -->
      <section class="settings-section">
        <h2 class="section-title">History</h2>

        <div id="history-list" class="history-list">
          <!-- History items will be populated here -->
        </div>

        <div id="no-history-message" class="no-history-message">
          <p>No prompt history yet.</p>
        </div>

        <button id="clear-history-btn" class="btn btn-danger" style="margin-top: 12px;">
          <svg viewBox="0 0 16 16" width="14" height="14" fill="currentColor">
            <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
          </svg>
          Clear History
        </button>
      </section>

      <!-- Available Variables Reference -->
      <section class="settings-section">
        <h2 class="section-title">Template Variables Reference</h2>

        <div class="variables-reference">
          <div class="variables-grid">
            <div class="variable-item">
              <code>{{repository}}</code>
              <span>Repository name (owner/repo)</span>
            </div>
            <div class="variable-item">
              <code>{{issueNumber}}</code>
              <span>Issue number</span>
            </div>
            <div class="variable-item">
              <code>{{title}}</code>
              <span>Issue title</span>
            </div>
            <div class="variable-item">
              <code>{{url}}</code>
              <span>Issue URL</span>
            </div>
            <div class="variable-item">
              <code>{{author}}</code>
              <span>Issue author username</span>
            </div>
            <div class="variable-item">
              <code>{{createdAt}}</code>
              <span>Creation date</span>
            </div>
            <div class="variable-item">
              <code>{{state}}</code>
              <span>Issue state (open/closed)</span>
            </div>
            <div class="variable-item">
              <code>{{labels}}</code>
              <span>Comma-separated labels</span>
            </div>
            <div class="variable-item">
              <code>{{description}}</code>
              <span>Full issue description</span>
            </div>
            <div class="variable-item">
              <code>{{codeBlocks}}</code>
              <span>Formatted code blocks</span>
            </div>
            <div class="variable-item">
              <code>{{errorLogs}}</code>
              <span>Extracted error logs</span>
            </div>
            <div class="variable-item">
              <code>{{reproductionSteps}}</code>
              <span>Reproduction steps</span>
            </div>
            <div class="variable-item">
              <code>{{expectedBehavior}}</code>
              <span>Expected behavior text</span>
            </div>
            <div class="variable-item">
              <code>{{actualBehavior}}</code>
              <span>Actual behavior text</span>
            </div>
            <div class="variable-item">
              <code>{{environment}}</code>
              <span>Environment info</span>
            </div>
            <div class="variable-item">
              <code>{{relevantComments}}</code>
              <span>Relevant comments</span>
            </div>
            <div class="variable-item">
              <code>{{linkedPRs}}</code>
              <span>Linked pull requests</span>
            </div>
            <div class="variable-item">
              <code>{{relatedIssues}}</code>
              <span>Related issues</span>
            </div>
          </div>

          <div class="syntax-help">
            <h4>Conditional Syntax</h4>
            <pre><code>{{#if errorLogs}}
## Error Logs
{{errorLogs}}
{{/if}}</code></pre>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="options-footer">
      <p>GitHub Issue to AI Prompt v1.0.0 | <a href="https://github.com" target="_blank">Report an Issue</a></p>
    </footer>

    <!-- Template Editor Modal -->
    <div id="template-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modal-title">Add New Template</h3>
          <button id="close-modal-btn" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="template-name">Template Name</label>
            <input type="text" id="template-name" class="text-input" placeholder="My Custom Template">
          </div>
          <div class="form-group">
            <label for="template-content">Template Content</label>
            <textarea id="template-content" class="textarea-input" placeholder="Enter your template here. Use {{variable}} for placeholders."></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-template-btn" class="btn btn-secondary">Cancel</button>
          <button id="save-template-btn" class="btn btn-primary">Save Template</button>
        </div>
      </div>
    </div>
  </div>

  <script src="options.js"></script>
</body>
</html>
